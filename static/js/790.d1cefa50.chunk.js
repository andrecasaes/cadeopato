"use strict";(self.webpackChunkpatolimpiadas_casaes=self.webpackChunkpatolimpiadas_casaes||[]).push([[790],{3719:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(5043),n=a(8185),o=a(579);const l=e=>{let{src:t,alt:a,variant:l,className:r,width:i,height:d}=e;const[c,u]=(0,s.useState)(!0);return(0,o.jsxs)("div",{className:"image-container",style:{position:"relative",width:i,height:d},children:[c&&(0,o.jsx)(n.A,{variant:l,width:i,height:d,style:{position:"absolute",top:0,left:0}}),(0,o.jsx)("img",{src:t,alt:a,className:r,onLoad:()=>u(!1),style:{display:c?"none":"block",borderRadius:"circular"===l?"50%":"",width:i,height:d}})]})}},1790:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var s=a(5043),n=a(6213),o=a(8729),l=a(5475),r=a(2314),i=a(5263),d=a(7392),c=a(5865),u=a(6446),h=a(611),x=a(547),p=a(5721),g=a(4628),j=a(8734),m=a(8185),v=a(8266),A=a(9901),f=a(1637),y=a(7332),b=a(4125),k=a(9506),w=a(79),C=a(3216),S=a(9573),N=a(5795),_=a(1906),$=a(4802),U=a(4510),E=a(3719),P=a(579);const B=e=>{var t,a;let{open:n,handleClose:o,duck:l,apiBaseUrl:r,onClueSolved:i}=e;const[h,x]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[j,m]=(0,s.useState)(l);(0,s.useEffect)((()=>{x(""),g(!1),m(l)}),[l]);return(0,P.jsx)(S.A,{open:n,onClose:o,"aria-labelledby":"solve-clue-modal-title",sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,P.jsxs)(u.A,{sx:{bgcolor:"background.paper",p:4,borderRadius:1,boxShadow:24,maxWidth:"600px",width:"90%",textAlign:"center",position:"relative"},children:[(0,P.jsxs)(c.A,{id:"solve-clue-modal-title",variant:"h6",gutterBottom:!0,children:["Charada #",null===j||void 0===j?void 0:j.id,(0,P.jsx)(d.A,{"aria-label":"fechar",onClick:o,sx:{position:"absolute",top:8,right:8},children:(0,P.jsx)($.A,{})})]}),null!==j&&void 0!==j&&null!==(t=j.clues[0])&&void 0!==t&&t.solved?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(c.A,{variant:"body1",sx:{mb:3},children:"Esta charada j\xe1 foi resolvida."}),(null===j||void 0===j?void 0:j.photo)&&(0,P.jsx)(u.A,{sx:{mb:3},children:(0,P.jsx)(E.A,{src:`${r}/${j.photo.replace(/\\/g,"/")}`,alt:`Pato ${j.id}`,variant:"rectangular",width:"100%"})})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.A,{sx:{mb:3},children:(0,P.jsx)(U.oz,{children:(null===j||void 0===j||null===(a=j.clues[0])||void 0===a?void 0:a.clue)||"Nenhuma charada dispon\xedvel."})}),(0,P.jsx)(N.A,{label:"Resposta",value:h,onChange:e=>{x(e.target.value.toUpperCase())},fullWidth:!0,margin:"normal",required:!0}),(0,P.jsx)(_.A,{variant:"contained",color:"primary",onClick:async()=>{var e;const t=null===j||void 0===j||null===(e=j.clues[0])||void 0===e?void 0:e.answer.toUpperCase();if(h===t){g(!0);try{const e=await fetch(`${r}/clues/${j.clues[0]._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({solved:!0})});if(e.ok){const t=await e.json();i(t),m((e=>({...e,clues:e.clues.map((e=>e._id===t._id?t:e))})))}}catch(a){console.error("Erro ao atualizar a charada:",a)}}else g(!1),alert("Resposta incorreta, tente novamente.")},sx:{mt:2},children:"Enviar Resposta"})]})]})})},R=()=>{const{authState:e}=(0,s.useContext)(o.c),[t,a]=(0,s.useState)([]),[S,N]=(0,s.useState)(!0),[_,$]=(0,s.useState)(0),[U,E]=(0,s.useState)(0),[R,z]=(0,s.useState)(0),[F,I]=(0,s.useState)(null),[T,W]=(0,s.useState)(!1),[q,D]=(0,s.useState)(null),[G,J]=(0,s.useState)(!1),L=(0,C.Zp)();e.user||(window.location.href="/");const O="https://api.cadeopato.app.br";(0,s.useEffect)((()=>{(async()=>{N(!0),I(null);try{const t=(await n.A.get(`${O}/ducks/search?userId=${e.user.selectedUser._id}`)).data;a(t);const s=t.filter((e=>e.found)).length,o=s/t.length*100;$(o),z(s),E(t.length)}catch(F){console.error("Error fetching ducks:",F),I("N\xe3o foi poss\xedvel carregar os dados. Por favor, contate o administrador.")}finally{N(!1)}})()}),[O,e.user.selectedUser._id]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(r.A,{className:"Appbar",position:"sticky",color:"default",children:[(0,P.jsxs)(i.A,{children:[(0,P.jsx)(d.A,{edge:"start",color:"inherit","aria-label":"back",onClick:()=>L(-1),children:(0,P.jsx)(y.A,{})}),(0,P.jsx)(c.A,{component:"div",sx:{flexGrow:1,alignItems:"center",textAlign:"center"},children:(0,P.jsxs)("h2",{style:{margin:0},children:[e.user.selectedUser.username," Dashboard"]})}),(0,P.jsx)(d.A,{edge:"end",color:"inherit",component:l.N_,to:"/ranking","aria-label":"ranking",children:(0,P.jsx)(b.A,{})})]}),(0,P.jsxs)(u.A,{sx:{paddingX:2,paddingBottom:2},children:[(0,P.jsx)(h.A,{variant:"determinate",value:_}),(0,P.jsxs)(c.A,{variant:"body2",color:"textSecondary",align:"center",children:[R," de ",U," patos encontrados"]})]})]}),(0,P.jsxs)("div",{className:"container py-4",children:[F&&(0,P.jsx)(x.A,{severity:"error",sx:{marginBottom:2},children:F}),(0,P.jsx)(p.A,{children:S?Array.from(new Array(5)).map(((e,t)=>(0,P.jsxs)(g.Ay,{className:"duck-list-item",children:[(0,P.jsx)(j.A,{primary:(0,P.jsx)(m.A,{variant:"text",width:"40%",height:30}),secondary:(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(m.A,{variant:"text",width:"60%",height:20})})}),(0,P.jsx)(v.A,{children:(0,P.jsx)(m.A,{variant:"rectangular",width:40,height:40})})]},t))):t.map((e=>(0,P.jsxs)(g.Ay,{className:"duck-list-item",button:!0,onClick:()=>(e=>{D(e),J(!0)})(e),children:[(0,P.jsx)(j.A,{primary:(0,P.jsxs)("h5",{children:["Pato ",e.id]}),secondary:(0,P.jsxs)("span",{children:["Tipo: ",e.type]})}),(0,P.jsx)(v.A,{children:(0,P.jsx)(A.A,{value:"check",selected:e.found,onChange:s=>{s.stopPropagation(),(async(e,s)=>{W(!0);try{await n.A.put(`${O}/ducks/${e}`,{found:s});const o=t.map((t=>t._id===e?{...t,found:s}:t));a(o);const l=o.filter((e=>e.found)).length,r=l/o.length*100;$(r),z(l),E(o.length)}catch(F){console.error(`Error marking duck as ${s?"found":"unfound"}:`,F),I("N\xe3o foi poss\xedvel atualizar o status do pato. Por favor, tente novamente.")}finally{W(!1)}})(e._id,!e.found)},className:e.found?"toggle-button-selected":"toggle-button-unselected",disabled:T,children:T?(0,P.jsx)(f.A,{size:24,sx:{color:"var(--accent-color)"}}):e.found?(0,P.jsx)(k.A,{style:{color:"#28a745"}}):(0,P.jsx)(w.A,{style:{color:"#dc3545"}})})})]},e._id)))})]}),(0,P.jsx)(B,{open:G,handleClose:()=>{D(null),J(!1)},duck:q,apiBaseUrl:O,onClueSolved:e=>{(e=>{const s=t.map((t=>t._id===e._id?e:t));a(s);const n=s.filter((e=>e.found)).length,o=n/s.length*100;$(o),z(n),E(s.length)})({...q,clues:[e]})}})]})}}}]);
//# sourceMappingURL=790.d1cefa50.chunk.js.map